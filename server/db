-- 1. Tạo Database
CREATE DATABASE IF NOT EXISTS green_garden_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE green_garden_db;

-- 2. Tạo bảng Users (Admin)
CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL, -- Lưu mật khẩu đã mã hóa (bcrypt)
    full_name VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 3. Tạo bảng Categories (Danh mục cây)
CREATE TABLE IF NOT EXISTS categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    slug VARCHAR(100) NOT NULL UNIQUE, -- Ví dụ: cay-an-qua
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 4. Tạo bảng Plants (Thông tin cây)
CREATE TABLE IF NOT EXISTS plants (
    id INT AUTO_INCREMENT PRIMARY KEY,
    category_id INT,
    name VARCHAR(150) NOT NULL,
    scientific_name VARCHAR(150),
    description TEXT, -- Có thể chứa HTML
    care_instruction TEXT,
    video_url VARCHAR(255),
    is_featured BOOLEAN DEFAULT FALSE, -- Cây nổi bật hiện trang chủ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE SET NULL
);

-- 5. Tạo bảng Plant Images (Album ảnh cho cây)
CREATE TABLE IF NOT EXISTS plant_images (
    id INT AUTO_INCREMENT PRIMARY KEY,
    plant_id INT NOT NULL,
    image_url VARCHAR(255) NOT NULL,
    is_thumbnail BOOLEAN DEFAULT FALSE, -- Ảnh đại diện
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (plant_id) REFERENCES plants(id) ON DELETE CASCADE
);

-- 6. Insert dữ liệu mẫu (để test)
INSERT INTO categories (name, slug, description) VALUES ('Cây Bonsai', 'cay-bonsai', 'Nghệ thuật cây cảnh dáng cổ thụ');